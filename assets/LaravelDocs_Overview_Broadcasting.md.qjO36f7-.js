import{_ as i,c as a,o as n,ag as h}from"./chunks/framework.DgDu2bHw.js";const d=JSON.parse('{"title":"实时广播","description":"","frontmatter":{},"headers":[],"relativePath":"LaravelDocs/Overview/Broadcasting.md","filePath":"LaravelDocs/Overview/Broadcasting.md"}'),l={name:"LaravelDocs/Overview/Broadcasting.md"};function p(k,s,t,e,F,r){return n(),a("div",null,s[0]||(s[0]=[h(`<h1 id="实时广播" tabindex="-1">实时广播 <a class="header-anchor" href="#实时广播" aria-label="Permalink to &quot;实时广播&quot;">​</a></h1><h2 id="概念" tabindex="-1">概念 <a class="header-anchor" href="#概念" aria-label="Permalink to &quot;概念&quot;">​</a></h2><p><strong>什么是实时广播？</strong></p><blockquote><ul><li>实时广播就像直播间的弹幕系统：当服务器发生事件时，能立即推送给所有在线的用户，让网页或应用实现&quot;实时更新&quot;效果。</li></ul></blockquote><p><strong>有什么用？</strong></p><ul><li><strong>实时聊天</strong>：用户间即时通讯</li><li><strong>动态通知</strong>：新消息实时提醒</li><li><strong>数据同步</strong>：多设备状态同步</li><li><strong>协作编辑</strong>：多人同时编辑文档</li><li><strong>实时监控</strong>：数据看板实时更新</li></ul><h2 id="一、广播驱动" tabindex="-1">一、广播驱动 <a class="header-anchor" href="#一、广播驱动" aria-label="Permalink to &quot;一、广播驱动&quot;">​</a></h2><p><strong>是什么？</strong></p><blockquote><ul><li>广播驱动是广播系统的&quot;快递公司&quot;，负责把事件从服务器推送到客户端。Laravel支持多种驱动：</li></ul></blockquote><ul><li><code>pusher</code>：第三方专业服务</li><li><code>redis</code>：自建高性能方案</li><li><code>log</code>：本地调试用（不真正广播）</li><li><code>null</code>：完全禁用广播</li></ul><p><strong>有什么用？</strong></p><ul><li>选择适合的推送服务</li><li>平衡成本与性能</li><li>方便本地开发调试</li></ul><p><strong>怎么用？</strong></p><ol><li><strong>安装广播依赖</strong></li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">composer</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> require</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> pusher/pusher-php-server</span><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"> # 使用Pusher时</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">composer</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> require</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> predis/predis</span><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"> # 使用Redis时</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li><strong>配置环境变量 <code>.env</code></strong></li></ol><div class="language-env vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span>BROADCAST_DRIVER=pusher # 或 redis</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Pusher配置</span></span>
<span class="line"><span>PUSHER_APP_ID=your_app_id</span></span>
<span class="line"><span>PUSHER_APP_KEY=your_app_key</span></span>
<span class="line"><span>PUSHER_APP_SECRET=your_app_secret</span></span>
<span class="line"><span>PUSHER_APP_CLUSTER=mt1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Redis配置</span></span>
<span class="line"><span>REDIS_HOST=127.0.0.1</span></span>
<span class="line"><span>REDIS_PASSWORD=null</span></span>
<span class="line"><span>REDIS_PORT=6379</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ol start="3"><li><strong>配置广播服务 <code>config/broadcasting.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">connections</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">    &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">pusher</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">driver</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">pusher</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">key</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> env</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">PUSHER_APP_KEY</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">secret</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> env</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">PUSHER_APP_SECRET</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">app_id</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> env</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">PUSHER_APP_ID</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">options</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">cluster</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> env</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">PUSHER_APP_CLUSTER</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">encrypted</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> true</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">    &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">redis</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">driver</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">redis</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">connection</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">default</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="4"><li><strong>实际应用：订单状态更新</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 创建事件</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">php artisan make</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">event OrderStatusUpdated</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// app/Events/OrderStatusUpdated.php</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> OrderStatusUpdated</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ShouldBroadcast</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    use</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Dispatchable</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> __construct</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 指定广播频道</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastOn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Channel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">orders.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 自定义广播数据</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastWith</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">status</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">status</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">updated_at</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">updated_at</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">toDateTimeString</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 在控制器中触发事件</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> updateOrderStatus</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">update</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">status</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">shipped</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 广播事件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">    event</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> OrderStatusUpdated</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> response</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">json</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">message</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">状态已更新</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="二、频道定义" tabindex="-1">二、频道定义 <a class="header-anchor" href="#二、频道定义" aria-label="Permalink to &quot;二、频道定义&quot;">​</a></h2><p><strong>是什么？</strong></p><blockquote><ul><li>频道就像不同的电视频道，客户端可以选择订阅感兴趣的频道，只接收特定频道的广播。</li></ul></blockquote><p><strong>有什么用？</strong></p><ul><li>隔离不同业务的消息</li><li>控制消息接收范围</li><li>实现私密通信</li><li>按权限分配频道</li></ul><p><strong>怎么用？</strong></p><ol><li><strong>定义公共频道</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 广播到公共频道</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastOn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Channel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">public-orders</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li><strong>定义私有频道（需要认证）</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 广播到私有频道</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastOn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> PrivateChannel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">user.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li><strong>频道认证 <code>routes/channels.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 私有频道认证</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Broadcast</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">channel</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">user.{userId}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">userId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> ===</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">userId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 复杂权限示例：订单频道</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Broadcast</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">channel</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">orders.{orderId}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">orderId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">find</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">orderId</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> ===</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user_id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> ||</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">isAdmin</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="4"><li><strong>实际应用：聊天室</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 事件：新消息</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> NewChatMessage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ShouldBroadcast</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> __construct</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Message</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 广播到聊天室频道</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastOn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> PrivateChannel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">chat.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">room_id</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 频道认证</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Broadcast</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">channel</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">chat.{roomId}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">roomId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">rooms</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">where</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">id</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">roomId</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">exists</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="三、laravel-echo" tabindex="-1">三、Laravel Echo <a class="header-anchor" href="#三、laravel-echo" aria-label="Permalink to &quot;三、Laravel Echo&quot;">​</a></h2><p><strong>是什么？</strong></p><blockquote><ul><li>Laravel Echo是前端的&quot;收音机&quot;，用于接收服务器广播的事件，并在浏览器中处理。</li></ul></blockquote><p><strong>有什么用？</strong></p><ul><li>简化前端事件监听</li><li>自动处理认证</li><li>支持多种驱动</li><li>提供优雅的API</li></ul><p><strong>怎么用？</strong></p><ol><li><strong>安装前端依赖</strong></li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">npm</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> install</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --save</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> pusher-js</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> laravel-echo</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li><strong>配置Echo <code>resources/js/bootstrap.js</code></strong></li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">import</span><span style="--shiki-light:#24292EFF;--shiki-dark:#8FBCBB;"> Echo</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> from</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">laravel-echo</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">import</span><span style="--shiki-light:#24292EFF;--shiki-dark:#8FBCBB;"> Pusher</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> from</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">pusher-js</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">window</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">Echo</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> Echo</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">    broadcaster</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">pusher</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">    key</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> process</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">env</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">MIX_PUSHER_APP_KEY</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">    cluster</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> process</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">env</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">MIX_PUSHER_APP_CLUSTER</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">    encrypted</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> true</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">    auth</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">        headers</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">X-CSRF-TOKEN</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> document</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">querySelector</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">meta[name=&quot;csrf-token&quot;]</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">getAttribute</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">content</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="3"><li><strong>监听公共频道</strong></li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 监听公共订单频道</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">Echo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">channel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">public-orders</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">OrderStatusUpdated</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">        console</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">订单状态更新:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 更新页面显示</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">        document</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">getElementById</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">order-</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">-status</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">innerText</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">status</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="4"><li><strong>监听私有频道</strong></li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 监听私有用户频道</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">Echo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">private</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">user.</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">userId</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">NotificationSent</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        alert</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">新通知: </span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">notification</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">title</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 显示通知</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        showNotification</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">notification</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="5"><li><strong>实际应用：实时聊天</strong></li></ol><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">&lt;!-- 聊天界面 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">chat</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">messages</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">input</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> type</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">text</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">message-input</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> onclick</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">sendMessage</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">()</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">发送</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">button</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">div</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">script</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 发送消息</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> sendMessage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> input</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> document</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">getElementById</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">message-input</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">    axios</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">post</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/chat/send</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">        message</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> input</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">value</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#88C0D0;">        room_id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;"> currentRoomId</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">    input</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">value</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 监听新消息</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">Echo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">private</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">chat.</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">currentRoomId</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">NewChatMessage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        const</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> messages</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> document</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">getElementById</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">messages</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">        messages</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">innerHTML</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> +=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> \`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">&lt;div class=&quot;message&quot;&gt;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">content</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">&lt;/div&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">        messages</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">scrollTop</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> messages</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">scrollHeight</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">script</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="完整示例-实时订单追踪系统" tabindex="-1">完整示例：实时订单追踪系统 <a class="header-anchor" href="#完整示例-实时订单追踪系统" aria-label="Permalink to &quot;完整示例：实时订单追踪系统&quot;">​</a></h2><ol><li><strong>后端设置</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// app/Events/OrderLocationUpdated.php</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> OrderLocationUpdated</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ShouldBroadcast</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> __construct</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> array</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastOn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> PrivateChannel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">orders.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// routes/channels.php</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Broadcast</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">channel</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">orders.{orderId}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">orderId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">where</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">id</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">orderId</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">where</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">user_id</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">exists</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ol start="2"><li><strong>前端监听</strong></li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// resources/js/order-tracking.js</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> orderId</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 123</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"> // 实际从页面获取</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">Echo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">private</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">orders.</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">orderId</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">OrderLocationUpdated</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        updateMapMarker</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        updateStatusBar</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">配送中: </span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">lat</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">, </span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">\${</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">e</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">lng</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">\`</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> updateMapMarker</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 更新地图标记</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">    console</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">log</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">更新位置:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;"> location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="3"><li><strong>模拟配送更新（测试用）</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 测试路由</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Route</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/test-delivery/{order}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">locations</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        [</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">lat</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 31</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">2304</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">lng</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 121</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">4737</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"> // 上海</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        [</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">lat</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 31</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">2243</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">lng</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 121</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">4755</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        [</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">lat</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 31</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">2200</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">lng</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 121</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">4800</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    foreach</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">locations</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> as</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        event</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> OrderLocationUpdated</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        sleep</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">5</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"> // 5秒更新一次位置</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="常见问题解答" tabindex="-1">常见问题解答 <a class="header-anchor" href="#常见问题解答" aria-label="Permalink to &quot;常见问题解答&quot;">​</a></h2><p><strong>Q：本地开发如何测试广播？</strong><br> A：使用 laravel-websockets 包：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">composer</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> require</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> beyondcode/laravel-websockets</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --provider=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">BeyondCode\\LaravelWebSockets\\WebSocketsServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> websockets:serve</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Q：如何限制广播事件？</strong><br> A：使用 broadcastWhen 方法：</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastWhen</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">status</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> !==</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">cancelled</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Q：前端如何取消订阅？</strong> A：</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 取消特定监听</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> listener</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;"> Echo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">private</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">chat.1</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">...</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">listener</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">stop</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 取消整个频道</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9;">Echo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">leave</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">chat.1</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>Q：如何广播给指定用户？</strong><br> A：使用私有频道 + 认证：</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 事件</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastOn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> PrivateChannel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">App.Models.User.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 认证</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Broadcast</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">channel</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">App.Models.User.{userId}</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">userId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">user</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> ===</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">userId</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Q：广播数据太大怎么办？</strong><br> A：精简广播数据：</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> broadcastWith</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">id</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">id</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">status</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">order</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">status</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 只发送必要数据</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Q：如何调试广播？</strong><br> A：</p><ul><li>查看WebSocket控制台</li><li>使用Laravel日志：</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 在事件中添加</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Log</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">debug</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">广播事件: </span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get_class</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">broadcastWith</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">())</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>`,74)]))}const g=i(l,[["render",p]]);export{d as __pageData,g as default};
