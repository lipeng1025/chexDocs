import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.DgDu2bHw.js";const d=JSON.parse('{"title":"包开发","description":"","frontmatter":{},"headers":[],"relativePath":"LaravelDocs/Overview/PackageDevelopment.md","filePath":"LaravelDocs/Overview/PackageDevelopment.md"}'),p={name:"LaravelDocs/Overview/PackageDevelopment.md"};function h(k,s,t,e,r,F){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="包开发" tabindex="-1">包开发 <a class="header-anchor" href="#包开发" aria-label="Permalink to &quot;包开发&quot;">​</a></h1><h2 id="概念" tabindex="-1">概念 <a class="header-anchor" href="#概念" aria-label="Permalink to &quot;概念&quot;">​</a></h2><p><strong>什么是包开发？</strong></p><blockquote><ul><li>包开发就是创建可复用的代码模块（就像乐高积木），可以轻松集成到多个Laravel项目中，避免重复造轮子。</li></ul></blockquote><p><strong>有什么用？</strong></p><ul><li>封装通用功能供多个项目使用</li><li>分享代码给社区</li><li>保持项目核心代码简洁</li><li>提高开发效率</li><li>方便功能升级和维护</li></ul><h2 id="一、包结构" tabindex="-1">一、包结构 <a class="header-anchor" href="#一、包结构" aria-label="Permalink to &quot;一、包结构&quot;">​</a></h2><p><strong>是什么？</strong></p><blockquote><ul><li>包结构就像给你的代码模块设计&quot;房间布局&quot;，合理的结构能让你的包更易用、更专业。</li></ul></blockquote><p><strong>有什么用？</strong></p><ul><li>组织代码逻辑清晰</li><li>符合Laravel标准规范</li><li>方便其他开发者使用</li><li>支持Composer自动加载</li><li>便于测试和维护</li></ul><p><strong>怎么用？</strong></p><ol><li><strong>创建基础目录结构</strong></li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  my-package/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> src/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> MyPackageServiceProvider.php</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> Facades/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">       └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> MyPackage.php</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> config/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> mypackage.php</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> resources/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> views/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> lang/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> tests/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> database/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> migrations/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> seeders/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> routes/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  │</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">   └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> web.php</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  ├──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> composer.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">  └──</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> README.md</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ol start="2"><li><strong>编辑composer.json文件</strong></li></ol><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">your-name/my-package</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">description</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">A simple Laravel package example</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">type</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">library</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">license</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MIT</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">authors</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">            &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Your Name</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">            &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">email</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">your@email.com</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">require</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">        &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">php</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">^8.0</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">        &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">laravel/framework</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">^10.0</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">autoload</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">        &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">psr-4</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">            &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">YourName</span><span style="--shiki-light:#D32F2F;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">MyPackage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">src/</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">extra</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">        &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">laravel</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">            &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">providers</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">                &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName</span><span style="--shiki-light:#22863A;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MyPackage</span><span style="--shiki-light:#22863A;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MyPackageServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">            ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">            &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">aliases</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">                &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">MyPackage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName</span><span style="--shiki-light:#22863A;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MyPackage</span><span style="--shiki-light:#22863A;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Facades</span><span style="--shiki-light:#22863A;--shiki-dark:#EBCB8B;">\\\\</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MyPackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ol start="3"><li><strong>创建服务提供者 <code>src/MyPackageServiceProvider.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">ServiceProvider</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> MyPackageServiceProvider</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ServiceProvider</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布配置文件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">publishes</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../config/mypackage.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> config_path</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">config</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布视图文件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">publishes</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../resources/views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> resource_path</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">views/vendor/mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 加载路由</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadRoutesFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../routes/web.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 加载视图</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadViewsFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../resources/views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 加载数据库迁移</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadMigrationsFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../database/migrations</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 加载语言文件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadTranslationsFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../resources/lang</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> register</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 合并配置</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">mergeConfigFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../config/mypackage.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">        )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 注册包的单例</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">singleton</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;"> \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><ol start="4"><li><strong>创建包主类 <code>src/MyPackage.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> MyPackage</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> hello</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">World</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Hello, </span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#22863A;--shiki-dark:#D8DEE9;">name</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">! From MyPackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> advancedMethod</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 包的核心功能实现</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="5"><li><strong>创建门面 <code>src/Facades/MyPackage.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Facade</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> MyPackage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> Facade</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    protected</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> static</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> getFacadeAccessor</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="6"><li><strong>创建配置文件 <code>config/mypackage.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">    &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">api_key</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> env</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MYPACKAGE_API_KEY</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">default_key</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">    &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">options</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">feature_enabled</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> true</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">max_attempts</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 5</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="7"><li><strong>创建示例视图 <code>resources/views/hello.blade.php</code></strong></li></ol><div class="language-blade vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">blade</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;!</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">DOCTYPE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> html</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">html</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">head</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">title</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">title</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">head</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">body</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">h1</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#81A1C1;">{{</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">message</span><span style="--shiki-light:#6F42C1;--shiki-dark:#81A1C1;"> }}</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">h1</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">body</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#81A1C1;">html</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="8"><li><strong>创建路由文件 <code>routes/web.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Route</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Route</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage/hello</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> ()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> MyPackage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">hello</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Laravel Developer</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Route</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage/view</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> ()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> view</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage::hello</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">        &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">message</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> MyPackage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">hello</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">View User</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">    ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="二、服务提供者" tabindex="-1">二、服务提供者 <a class="header-anchor" href="#二、服务提供者" aria-label="Permalink to &quot;二、服务提供者&quot;">​</a></h2><p><strong>是什么？</strong></p><blockquote><ul><li>服务提供者就像包的&quot;启动引擎&quot;，负责将包集成到Laravel应用中。</li></ul></blockquote><p><strong>有什么用？</strong></p><ul><li>注册包的服务到容器</li><li>初始化包的功能</li><li>发布资源文件</li><li>定义路由和事件</li><li>扩展Laravel核心功能</li></ul><p><strong>怎么用？</strong></p><ol><li><strong>基本结构</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">ServiceProvider</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> MyPackageServiceProvider</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ServiceProvider</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 注册绑定到容器</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> register</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">singleton</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> MyPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">config</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage.api_key</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 启动包服务</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 初始化逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ol start="2"><li><strong>注册命令</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">runningInConsole</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">commands</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">            \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Console</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">InstallCommand</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::class</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="3"><li><strong>创建安装命令 <code>src/Console/InstallCommand.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">Console</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Console</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Command</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> InstallCommand</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> Command</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    protected</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">signature</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage:install</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    protected</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">description</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Install MyPackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> handle</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">info</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Installing MyPackage...</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布配置文件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">call</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">vendor:publish</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">--provider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName\\MyPackage\\MyPackageServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">--tag</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">config</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布视图</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">call</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">vendor:publish</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">--provider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName\\MyPackage\\MyPackageServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">--tag</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 运行迁移</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">call</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">migrate</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">info</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">MyPackage installed successfully!</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ol start="4"><li><strong>扩展Laravel功能</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 扩展验证规则</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">    \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Validator</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">extend</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">custom_rule</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">attribute</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">value</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">parameters</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">value</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> ===</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">custom</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 添加中间件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">    $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">router</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">aliasMiddleware</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">package_middleware</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;"> \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Middleware</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">PackageMiddleware</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::class</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 注册事件监听器</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">    $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">events</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">        \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">App</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Events</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">UserRegistered</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::class</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">        \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Listeners</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">SendWelcomeNotification</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::class</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">    )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ol start="5"><li><strong>条件加载服务</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> register</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 仅在特定环境注册服务</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">environment</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">production</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">singleton</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> ProductionPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> else</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">singleton</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> DevelopmentPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="6"><li><strong>延迟加载服务提供者</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> MyPackageServiceProvider</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ServiceProvider</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    protected</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">defer</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;"> true</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"> // 延迟加载</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> provides</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="完整示例-开发一个简单的统计包" tabindex="-1">完整示例：开发一个简单的统计包 <a class="header-anchor" href="#完整示例-开发一个简单的统计包" aria-label="Permalink to &quot;完整示例：开发一个简单的统计包&quot;">​</a></h2><ol><li><strong>包结构</strong></li></ol><div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span>statistics-package/</span></span>
<span class="line"><span>├── src/</span></span>
<span class="line"><span>│   ├── StatisticsServiceProvider.php</span></span>
<span class="line"><span>│   ├── Facades/</span></span>
<span class="line"><span>│   │   └── Statistics.php</span></span>
<span class="line"><span>│   ├── Services/</span></span>
<span class="line"><span>│   │   └── StatisticsService.php</span></span>
<span class="line"><span>│   └── Models/</span></span>
<span class="line"><span>│       └── PageView.php</span></span>
<span class="line"><span>├── config/</span></span>
<span class="line"><span>│   └── statistics.php</span></span>
<span class="line"><span>├── database/</span></span>
<span class="line"><span>│   ├── migrations/</span></span>
<span class="line"><span>│   │   └── 2023_01_01_000000_create_page_views_table.php</span></span>
<span class="line"><span>│   └── seeders/</span></span>
<span class="line"><span>├── resources/</span></span>
<span class="line"><span>│   └── views/</span></span>
<span class="line"><span>│       └── dashboard.blade.php</span></span>
<span class="line"><span>├── routes/</span></span>
<span class="line"><span>│   └── web.php</span></span>
<span class="line"><span>├── tests/</span></span>
<span class="line"><span>├── composer.json</span></span>
<span class="line"><span>└── README.md</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ol start="2"><li><strong>服务提供者 <code>src/StatisticsServiceProvider.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">Statistics</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">ServiceProvider</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> StatisticsServiceProvider</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> ServiceProvider</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布配置文件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">publishes</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../config/statistics.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> config_path</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">config</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布迁移文件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">publishes</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../database/migrations</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> database_path</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">migrations</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">migrations</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 发布视图</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">publishes</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../resources/views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> resource_path</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">views/vendor/statistics</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">),</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 加载路由</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadRoutesFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../routes/web.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">        // 加载视图</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadViewsFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../resources/views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> register</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">mergeConfigFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">            __DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../config/statistics.php</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">        )</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">singleton</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            return</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> new</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Services</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">StatisticsService</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><ol start="3"><li><strong>统计服务 <code>src/Services/StatisticsService.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">Statistics</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">Services</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Statistics</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Models</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">PageView</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Auth</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> StatisticsService</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> trackPageView</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">config</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics.enabled</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">            PageView</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">create</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">                &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">url</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">fullUrl</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">                &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">ip</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">ip</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">                &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">user_id</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Auth</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">id</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">                &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">user_agent</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">userAgent</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">            ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> getPageViews</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> PageView</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">count</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> getPopularPages</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> PageView</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">select</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">url</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            -&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">selectRaw</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">COUNT(*) as views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            -&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">groupBy</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">url</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            -&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">orderByDesc</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            -&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">limit</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;">10</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">            -&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><ol start="4"><li><strong>路由 <code>routes/web.php</code></strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Route</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Statistics</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Statistics</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 跟踪页面访问的中间件</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Route</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">middleware</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">web</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">group</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> ()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">    Route</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics/track</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Http</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Request</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">        Statistics</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">trackPageView</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> response</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">json</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">status</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">tracked</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 统计仪表盘</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">    Route</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">get</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics/dashboard</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> ()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> view</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">statistics::dashboard</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">totalViews</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Statistics</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">getPageViews</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(),</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">popularPages</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Statistics</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">getPopularPages</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">middleware</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">auth</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ol start="5"><li><strong>在应用中使用包</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 在AppServiceProvider中</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">    // 记录所有页面访问</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">    \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Support</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Event</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">listen</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">Illuminate\\Routing\\Events\\RouteMatched</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">event</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">        \\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Statistics</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Facades</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Statistics</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">trackPageView</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">event</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="6"><li><strong>安装包</strong></li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 在Laravel项目中</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">composer</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> require</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> your-name/statistics</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 发布配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --provider=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName\\Statistics\\StatisticsServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tag=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">config</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 发布迁移文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --provider=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName\\Statistics\\StatisticsServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tag=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">migrations</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 运行迁移</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> migrate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="包开发最佳实践" tabindex="-1">包开发最佳实践 <a class="header-anchor" href="#包开发最佳实践" aria-label="Permalink to &quot;包开发最佳实践&quot;">​</a></h2><ol><li><strong>版本控制</strong></li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 初始化Git仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">git</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> init</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 设置版本号</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">git</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> tag</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> v1.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 推送到远程仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">git</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> push</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> origin</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tags</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="2"><li><strong>测试包</strong></li></ol><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// tests/StatisticsTest.php</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> StatisticsTest</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> TestCase</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> test_tracks_page_view</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">        $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;"> Request</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">create</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/test</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">GET</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        app</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">StatisticsService</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::class</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">trackPageView</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">$</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">request</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">assertDatabaseHas</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">page_views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">            &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">url</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =&gt;</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/test</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>运行测试：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">composer</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="3"><li><strong>发布包到Packagist</strong></li></ol><ul><li>在GitHub创建仓库</li><li>在Packagist提交包</li><li>配置GitHub Webhook自动更新</li></ul><ol start="4"><li><strong>语义化版本控制</strong></li></ol><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">版本号格式：MAJOR.MINOR.PATCH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">-</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;"> MAJOR：不兼容的API修改</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">-</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;"> MINOR：向后兼容的功能新增</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">-</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;"> PATCH：向后兼容的问题修复</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="5"><li><strong>持续集成配置 <code>.github/workflows/tests.yml</code></strong></li></ol><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> Tests</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">on</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> [</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">push</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> pull_request</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">jobs</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">  tests</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">    runs-on</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">    steps</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">      -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;"> uses</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> actions/checkout@v2</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">      </span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">      -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;"> name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> Setup PHP</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">        uses</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> shivammathur/setup-php@v2</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">        with</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">          php-version</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#B48EAD;"> 8.2</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">          extensions</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> dom, curl, libxml, mbstring, zip, pdo, sqlite</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">          coverage</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> xdebug</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">          </span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">      -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;"> name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> Install Dependencies</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">        run</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> composer install -n --prefer-dist</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">      -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;"> name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> Generate .env</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">        run</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> cp .env.example .env</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">        </span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">      -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;"> name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> Create Database</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">        run</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> |</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">          touch database/database.sqlite</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">          php artisan migrate --database=sqlite --force</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">          </span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">      -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;"> name</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> Run Tests</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">        run</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;"> php artisan test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="常见问题解答" tabindex="-1">常见问题解答 <a class="header-anchor" href="#常见问题解答" aria-label="Permalink to &quot;常见问题解答&quot;">​</a></h2><p><strong>Q：如何本地测试包？</strong><br> A：使用Composer路径加载：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 在Laravel项目的composer.json中添加</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">&quot;repositories&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        &quot;type&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">path</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">        &quot;url&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">../my-package</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 然后安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">composer</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> require</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> your-name/my-package:@dev</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Q：如何更新包的迁移文件？</strong><br> A：</p><ul><li>更新包中的迁移文件</li><li>重新发布迁移：</li></ul><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tag=migrations</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --force</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>Q：包中如何使用Eloquent模型？</strong><br> A：</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;"> YourName</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">MyPackage</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D8DEE9FF;">Models</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">use</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;"> Illuminate</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Database</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">Eloquent</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">Model</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#8FBCBB;"> PackageModel</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:inherit;--shiki-dark:#8FBCBB;--shiki-dark-font-weight:bold;"> Model</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    protected</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;"> $</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">table</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">package_table</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Q：如何创建包配置命令？</strong><br> A：</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 在服务提供者中</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">$this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9;">app</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">runningInConsole</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">        $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">commands</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">[</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#D8DEE9FF;">            Console</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">\\</span><span style="--shiki-light:#1976D2;--shiki-dark:#8FBCBB;">PackageCommand</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">::class</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">        ]</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Q：包如何依赖其他包？</strong><br> A：在composer.json中添加：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">require</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D8DEE9FF;">: </span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">    &quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#8FBCBB;">guzzlehttp/guzzle</span><span style="--shiki-light:#D32F2F;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">^7.0</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Q：如何处理包中的视图？</strong><br> A：</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 在服务提供者中</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> boot</span><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">    $this</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">loadViewsFrom</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#81A1C1;">__DIR__</span><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">.</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">/../resources/views</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;"> &#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;">// 在代码中使用</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#81A1C1;">return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;"> view</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">mypackage::view-name</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&#39;</span><span style="--shiki-light:#212121;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#81A1C1;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Q：如何发布包资源？</strong><br> A：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light nord vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 发布配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tag=config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 发布视图</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tag=views</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 发布迁移</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --tag=migrations</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#616E88;"># 发布所有</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#88C0D0;">php</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> artisan</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> vendor:publish</span><span style="--shiki-light:#2B5581;--shiki-dark:#A3BE8C;"> --provider=</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#22863A;--shiki-dark:#A3BE8C;">YourName\\MyPackage\\MyPackageServiceProvider</span><span style="--shiki-light:#22863A;--shiki-dark:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div>`,88)]))}const g=i(p,[["render",h]]);export{d as __pageData,g as default};
